http{
     upstream loadbalancer {
        server node-app:4000 weight=6;
        server node-app-notifications:4001 weight=4;
    }
    server{
        listen 80;
        listen [::]:80;
        server_name happyday.nicolasdeheza.com;

        include /etc/nginx/mime.types;

        location / {
            root /usr/share/nginx/html;
            index index.html index.html;
            try_files $uri $uri/ /index.html;
        }

        location /api{
            proxy_pass http://loadbalancer;
        }

        location ~ /.well-known/acme-challenge {
                allow all;
                root /usr/share/nginx/html;
        }
    }
}

events{}
